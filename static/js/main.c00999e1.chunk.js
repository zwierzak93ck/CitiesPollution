(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{195:function(e,t,n){e.exports=n(309)},309:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(11),c=n.n(o),i=n(29),u=n(30),l=n(34),s=n(31),d=n(33),p=n(63),f=n.n(p),h=n(93),m=n(100),b=n(26),v=n.n(b),g=n(27),E=n.n(g),y=n(64),j=function(e){return console.log(e),r.a.createElement(v.a,{className:"flex-container"},r.a.createElement(E.a,{className:"card-content"},r.a.createElement(m.a,{value:e.setValue,options:e.options,onChange:e.onChange,isClearable:!0})),r.a.createElement(y.b,{className:"card-actions"},r.a.createElement(y.a,{onClick:e.onClick,variant:"contained",color:"primary"},"Get")))},C=function(e){return new Promise(function(t,n){var a=e.transaction("state","readonly").objectStore("state").get(1);a.onsuccess=function(){return t(a.result)},a.onerror=function(){return n(a.error)}})},O=n(50),w=n.n(O),k=n(32),x=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(l.a)(this,Object(s.a)(t).call(this,e))).countries=[{value:"FR",label:"France"},{value:"DE",label:"Germany"},{value:"PL",label:"Poland"},{value:"ES",label:"Spain"}],n.onValueChange=function(e){n.setState({country:e||null})},n.getMostPollutedCities=function(){w.a.get("https://api.openaq.org/v1/cities?country="+n.state.country.value+"&order_by=count&limit=10&sort=desc").then(function(e){var t=e.data.results.map(function(e){return e.city});console.log(t),n.props.setCities(t)})},n.state={country:null},n}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=Object(h.a)(f.a.mark(function e(){var t,n=this;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise(function(e,t){var n=window.indexedDB.open("database - mostPollutedCities",1);n.onupgradeneeded=function(){n.result.createObjectStore("state",{keyPath:"id"})},n.onsuccess=function(){return e(n.result)},n.onerror=function(){return t(n.error)},n.onblocked=function(){alert("Blocked")}});case 2:return t=e.sent,e.next=5,C(t).then(function(e){n.setState({country:e?e.data.country:null})});case 5:window.onbeforeunload=function(){var e,a;e=t,a=n.state,new Promise(function(t,n){var r=e.transaction("state","readwrite").objectStore("state").put({id:1,data:a});r.onsuccess=function(){return t(r.result)},r.onerror=function(){return n(r.error)}})};case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(j,{options:this.countries,onChange:this.onValueChange,setValue:this.state.country,onClick:this.getMostPollutedCities}))}}]),t}(a.Component),S=Object(k.b)(null,function(e){return{setCities:function(t){e({type:"SET_CITIES",cities:t})}}})(x),P=n(45),D=n.n(P),I=n(47),N=n.n(I),M=n(46),T=n.n(M),V=function(e){return console.log(e),r.a.createElement(v.a,{className:"flex-container"},r.a.createElement(E.a,{className:"card-content"},r.a.createElement(D.a,{expanded:e.expanded,onChange:e.handleChange},r.a.createElement(T.a,null,r.a.createElement("h2",null,e.city)),r.a.createElement(N.a,null,r.a.createElement("div",null)))))},B=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(l.a)(this,Object(s.a)(t).call(this,e))).handleChange=function(e){return function(t,a){console.log(e),n.setState({expanded:!a||e})}},n.getDescription=function(e){console.log(e),w.a.get("https://en.wikipedia.org/w/api.php?origin=*&action=query&list=search&srsearch="+e+"&format=json").then(function(e){n.setState({description:e})})},n.state={expanded:null,description:null},n}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this;return this.props.cities.map(function(t){return r.a.createElement(V,{city:t,key:Date.now()+Math.random(),handleChange:e.handleChange(t),expanded:e.state.expanded===t,description:e.getDescription(t)})})}}]),t}(a.Component),_=Object(k.b)(function(e){return{cities:e.cities}})(B),q=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(S,null),r.a.createElement(_,null))}}]),t}(a.Component),F=n(51),G=n(99),J={cities:[]},L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CITIES":return Object(G.a)({},e,{cities:t.cities});default:return e}},R=Object(F.b)(L);c.a.render(r.a.createElement(k.a,{store:R},r.a.createElement(q,null)),document.getElementById("root"))}},[[195,1,2]]]);
//# sourceMappingURL=main.c00999e1.chunk.js.map