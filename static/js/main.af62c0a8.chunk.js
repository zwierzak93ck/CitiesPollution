(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{220:function(t,e,n){t.exports=n(369)},368:function(t,e,n){},369:function(t,e,n){"use strict";n.r(e);var r=n(0),a=n.n(r),o=n(16),i=n.n(o),c=n(24),u=n(58),s=n(138),l={informations:null},f=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"SET_CITIES_INFORMATIONS":return Object(s.a)({},t,{informations:e.informations});default:return t}},p=n(37),m=n(38),d=n(40),h=n(39),b=n(41),v=n(55),y=n.n(v),O=Object(r.lazy)(function(){return Promise.all([n.e(3),n.e(4)]).then(n.bind(null,379))}),j=function(t){function e(t){var n;return Object(p.a)(this,e),(n=Object(d.a)(this,Object(h.a)(e).call(this,t))).handleChange=function(t){return function(e,r){n.setState({expanded:!r||t})}},n.state={expanded:null},n}return Object(b.a)(e,t),Object(m.a)(e,[{key:"render",value:function(){var t=this;return a.a.createElement(r.Suspense,{fallback:a.a.createElement("h1",null,"Loading ",a.a.createElement(y.a,{color:"primary"}))},this.props.informations.name.map(function(e){return a.a.createElement(O,{name:e,description:t.props.informations.description[t.props.informations.name.indexOf(e)],key:Date.now()+Math.random(),handleChange:t.handleChange(e),expanded:t.state.expanded===e})}))}}]),e}(r.Component),w=Object(c.b)(function(t){return{informations:t.informations}})(j),g=n(18),x=n.n(g),C=n(27),E=n(139),k=n(56),S=n.n(k),I=n(57),N=n.n(I),P=n(61),T=function(t){return a.a.createElement(S.a,{className:"flex-container search-form"},a.a.createElement(N.a,{className:"card-content"},a.a.createElement(E.a,{value:t.country,options:t.options,onChange:t.onChange,isClearable:!0}),a.a.createElement(P.c,{value:t.limit,type:"number",placeholder:"Number of cities",onChange:t.onChange})),a.a.createElement(P.b,{className:"card-actions"},a.a.createElement(P.a,{className:"button",onClick:t.onClick,variant:"contained",color:"primary",disabled:!t.validate},"Get Data")))},D=function(t){return new Promise(function(e,n){var r=t.transaction("state","readonly").objectStore("state").get(1);r.onsuccess=function(){return e(r.result)},r.onerror=function(){return n(r.error)}})},_=n(46),F=n.n(_),M=function(){var t=Object(C.a)(x.a.mark(function t(e,n){var r,a;return x.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=F.a.get("https://api.openaq.org/v1/cities?country="+e+"&order_by=count&limit="+n+"&sort=desc"),t.next=3,F.a.all([r]);case 3:return a=t.sent,t.abrupt("return",a[0].data.results.map(function(t){return t.city}));case 5:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}(),q=function(){var t=Object(C.a)(x.a.mark(function t(e){var n,r,a,o;return x.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(n=[],r=0;r<e.length;r++)a=F.a.get("https://en.wikipedia.org/w/api.php?origin=*&action=query&redirects=1&titles="+e[r]+"&format=json&prop=extracts&exintro&explaintext"),n.push(a);return t.next=4,F.a.all(n);case 4:return o=t.sent,t.abrupt("return",o.map(function(t){var e=t.data.query.pages;return Object.values(e)[0].extract}));case 6:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),B=function(){var t=Object(C.a)(x.a.mark(function t(e,n){var r,a,o;return x.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,M(e,n);case 2:return r=t.sent,t.next=5,q(r);case 5:return a=t.sent,o={name:r,description:a},t.abrupt("return",o);case 8:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}(),R=[{value:"FR",label:"France"},{value:"DE",label:"Germany"},{value:"PL",label:"Poland"},{value:"ES",label:"Spain"}],A=function(t){function e(t){var n;return Object(p.a)(this,e),(n=Object(d.a)(this,Object(h.a)(e).call(this,t))).onValueChange=function(t){t.target?n.setState({limit:t.target.value}):n.setState({country:t||null})},n.setCitiesInformations=Object(C.a)(x.a.mark(function t(){return x.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=n.props,t.next=3,B(n.state.country.value,n.state.limit);case 3:t.t1=t.sent,t.t0.setCitiesInformations.call(t.t0,t.t1);case 5:case"end":return t.stop()}},t)})),n.state={country:"",limit:0},n}return Object(b.a)(e,t),Object(m.a)(e,[{key:"componentDidMount",value:function(){var t=Object(C.a)(x.a.mark(function t(){var e,n=this;return x.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise(function(t,e){var n=window.indexedDB.open("database - mostPollutedCities",1);n.onupgradeneeded=function(){n.result.createObjectStore("state",{keyPath:"id"})},n.onsuccess=function(){return t(n.result)},n.onerror=function(){return e(n.error)},n.onblocked=function(){alert("Blocked")}});case 2:return e=t.sent,t.next=5,D(e).then(function(t){n.setState({country:t?t.data.country:null,limit:t?t.data.limit:null})});case 5:window.onbeforeunload=function(){var t,r;t=e,r=n.state,new Promise(function(e,n){var a=t.transaction("state","readwrite").objectStore("state").put({id:1,data:r});a.onsuccess=function(){return e(a.result)},a.onerror=function(){return n(a.error)}})};case 6:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){return a.a.createElement(T,{options:R,onChange:this.onValueChange,country:this.state.country,limit:this.state.limit,onClick:this.setCitiesInformations,validate:(t=[this.state.country,this.state.limit],!!t&&t.every(function(t){return t}))});var t}}]),e}(r.Component),G=Object(c.b)(null,function(t){return{setCitiesInformations:function(e){t({type:"SET_CITIES_INFORMATIONS",informations:e})}}})(A),J=(n(368),function(t){function e(){return Object(p.a)(this,e),Object(d.a)(this,Object(h.a)(e).apply(this,arguments))}return Object(b.a)(e,t),Object(m.a)(e,[{key:"render",value:function(){return a.a.createElement("div",null,a.a.createElement(G,null),this.props.informations?a.a.createElement(w,null):null)}}]),e}(r.Component)),L=Object(c.b)(function(t){return{informations:t.informations}})(J),V=Object(u.b)(f);i.a.render(a.a.createElement(c.a,{store:V},a.a.createElement(L,null)),document.getElementById("root"))}},[[220,1,2]]]);
//# sourceMappingURL=main.af62c0a8.chunk.js.map